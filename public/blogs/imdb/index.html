<!DOCTYPE HTML>
<html>

    <head>
	<meta charset="utf-8" />
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
	<meta name="description" content="Student">
	<meta name="author" content="Peijun Xu">
	<meta name="generator" content="Hugo 0.74.3" />
	<title>IMDB Analysis &middot; Portfolio website for Peijun Xu</title>
	<!-- Stylesheets -->
	
	<link rel="stylesheet" href="/css/main.css"/>
	
	

	

	<!-- Custom Fonts -->
	<link href="/css/font-awesome.min.css" rel="stylesheet" type="text/css">

	
	<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico">
	<link rel="icon" type="image/x-icon" href="/favicon.ico">
	

	<!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
	<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
	<!--[if lt IE 9]>
	<script src="js/ie/html5shiv.js"></script>
	<script src="js/ie/html5shiv.jsrespond.min.js"></script>
	<![endif]-->
</head>

    <body>

    <!-- Wrapper -->
        <div id="wrapper">

            <!-- Header -->
    <header id="header" class="alt">
        <a href="/" class="logo"><strong>Peijun Xu</strong> <span>Portfolio Website</span></a>
        <nav>
            <a href="#menu">Menu</a>
        </nav>
    </header>

<!-- Menu -->
    <nav id="menu">
        <ul class="links">
            
                <li><a href="/">Home</a></li>
            
                <li><a href="/blogs">Blogs</a></li>
            
                <li><a href="/blogs/ipsum">Generic Blog</a></li>
            
                <li><a href="/elements.html">Elements</a></li>
            

        </ul>
        <ul class="actions vertical">
            
                <li><a href="/blogs" class="button special fit">Get Started</a></li>
            
            
                <li><a href="/" class="button fit">Log In</a></li>
            
        </ul>
    </nav>

        <!-- Main -->
            <div id="main" class="alt">

                
                    <section id="one">
                        <div class="inner">
                            <header class="major">
                                <h1>IMDB Analysis</h1>
                            </header>
                            
                                <span class="image main"><img src="/img/blogs/pic06.jpg" alt="" /></span>
                            
                            


<pre class="r"><code>knitr::opts_chunk$set(
  message = FALSE, 
  warning = FALSE, 
  tidy=FALSE,     # display code as typed
  size=&quot;small&quot;)   # slightly smaller font for code
options(digits = 3)

# default figure size
knitr::opts_chunk$set(
  fig.width=6.75, 
  fig.height=6.75,
  fig.align = &quot;center&quot;
)</code></pre>
<pre><code>## Rows: 2,961
## Columns: 11
## $ title               &lt;chr&gt; &quot;Avatar&quot;, &quot;Titanic&quot;, &quot;Jurassic World&quot;, &quot;The Ave...
## $ genre               &lt;chr&gt; &quot;Action&quot;, &quot;Drama&quot;, &quot;Action&quot;, &quot;Action&quot;, &quot;Action&quot;...
## $ director            &lt;chr&gt; &quot;James Cameron&quot;, &quot;James Cameron&quot;, &quot;Colin Trevor...
## $ year                &lt;dbl&gt; 2009, 1997, 2015, 2012, 2008, 1999, 1977, 2015,...
## $ duration            &lt;dbl&gt; 178, 194, 124, 173, 152, 136, 125, 141, 164, 93...
## $ gross               &lt;dbl&gt; 7.61e+08, 6.59e+08, 6.52e+08, 6.23e+08, 5.33e+0...
## $ budget              &lt;dbl&gt; 2.37e+08, 2.00e+08, 1.50e+08, 2.20e+08, 1.85e+0...
## $ cast_facebook_likes &lt;dbl&gt; 4834, 45223, 8458, 87697, 57802, 37723, 13485, ...
## $ votes               &lt;dbl&gt; 886204, 793059, 418214, 995415, 1676169, 534658...
## $ reviews             &lt;dbl&gt; 3777, 2843, 1934, 2425, 5312, 3917, 1752, 1752,...
## $ rating              &lt;dbl&gt; 7.9, 7.7, 7.0, 8.1, 9.0, 6.5, 8.7, 7.5, 8.5, 7....</code></pre>
<div id="use-your-data-import-inspection-and-cleaning-skills-to-answer-the-following" class="section level2">
<h2>Use your data import, inspection, and cleaning skills to answer the following:</h2>
<ul>
<li>Produce a table with the count of movies by genre, ranked in descending order</li>
</ul>
<pre class="r"><code>genre_count &lt;- movies %&gt;%
  distinct() %&gt;% 
  group_by(genre) %&gt;%
  summarise(count = n())

ggplot(genre_count) +
  geom_col(aes(count, reorder(genre, count)), fill = &quot;black&quot;) +
  labs(
    title = &quot;Count of Movies by Genre&quot;,
    caption = &quot;Data from imdb.com&quot;,
    x = &quot;Count&quot;,
    y = element_blank()
  ) +
  theme(panel.background = element_rect(&quot;#ffd700&quot;)) +
  #theme(panel.grid = element_blank()) +
  theme(plot.background = element_rect(&quot;#ffd700&quot;))</code></pre>
<p><img src="/blogs/imdb_files/figure-html/kable_movies_by_genre-1.png" width="648" style="display: block; margin: auto;" /></p>
<ul>
<li>Produce a table with the average gross earning and budget (<code>gross</code> and <code>budget</code>) by genre.
Calculate a variable <code>return_on_budget</code> which shows how many $ did a movie make at the box office for each $ of its budget. Ranked genres by this <code>return_on_budget</code> in descending order</li>
</ul>
<pre class="r"><code>options(scipen=999)
avg_genre &lt;- movies %&gt;% 
 group_by(genre) %&gt;% 
 summarise(mean_gross = mean(gross), #Summarised to get mean gross earnings
            mean_budget = mean(budget)) %&gt;% #summarised to get mean budget
 mutate(return_on_budget = mean_gross/mean_budget) %&gt;% #added column for return on budget.
 arrange(desc(return_on_budget)) %&gt;% #arranged table in descending order of return on budget
 ggplot() +
  geom_col(aes(return_on_budget, reorder(genre, return_on_budget)), fill = &quot;black&quot;) +
  labs(
    title = &quot;Average Return on Budget by Genre&quot;,
    caption = &quot;Data from imdb.com&quot;,
    x = &quot;Return on Budget (%)&quot;,
    y = element_blank()
  ) +
  theme(panel.background = element_rect(&quot;#ffd700&quot;)) +
  #theme(panel.grid = element_blank()) +
  theme(plot.background = element_rect(&quot;#ffd700&quot;))

avg_genre</code></pre>
<p><img src="/blogs/imdb_files/figure-html/average_gross_and_budget_by_genre-1.png" width="648" style="display: block; margin: auto;" /></p>
<ul>
<li>Produce a table that shows the top 15 directors who have created the highest gross revenue in the box office. Don’t just show the total gross amount, but also the mean, median, and standard deviation per director.</li>
</ul>
<pre class="r"><code>options(scipen=99999)
top15_directors &lt;- movies %&gt;% group_by(director) %&gt;%
  summarise(total_gross_director = sum(gross),
            mean_director = mean(gross),
            median_director = median(gross),
            sd_director = sd(gross)) %&gt;%
  slice_max(order_by = total_gross_director,n = 15) %&gt;% #used slice_max to select top 15 directors by total gross.
  ggplot() +
  geom_col(aes(total_gross_director / 1000000, reorder(director, total_gross_director)), fill = &quot;black&quot;) +
  labs(
    title = &quot;Gross Revenue in the Box Office&quot;,
    caption = &quot;Data from imdb.com&quot;,
    x = &quot;Gross Revenue (million dollars)&quot;,
    y = element_blank()
  ) +
  theme(panel.background = element_rect(&quot;#ffd700&quot;)) +
  #theme(panel.grid = element_blank()) +
  theme(plot.background = element_rect(&quot;#ffd700&quot;))
top15_directors</code></pre>
<p><img src="/blogs/imdb_files/figure-html/top15_directors-1.png" width="648" style="display: block; margin: auto;" /></p>
<ul>
<li>Finally, ratings. Produce a table that describes how ratings are distributed by genre. We don’t want just the mean, but also, min, max, median, SD and some kind of a histogram or density graph that visually shows how ratings are distributed.</li>
</ul>
<p>Histogram Graph:</p>
<pre class="r"><code>ratings_table &lt;- movies %&gt;% #Assigned the requested variables to ratings table
  group_by(genre) %&gt;%
  summarise(mean_rating = mean(rating),
            median_rating = median(rating),
            sd_rating = sd(rating),
            min_rating = min(rating),
            max_rating = max(rating))

rating_graph &lt;- ggplot(ratings_table, aes(#Used ratings table to plot graph
  x = reorder(genre, -mean_rating), #reordered genre by descendin mean rating
  y = mean_rating
  )) +
  geom_col(width=0.7, position=position_dodge(width=0.8)) +
  labs(
    x = &quot;Genre&quot;, 
    y = &quot;Mean Ratings&quot;, 
    title = &quot;Ratings by Genre&quot;) +
  theme_minimal() +
  theme(text = element_text(size=40))+
  NULL</code></pre>
<pre class="r"><code>skim(movies)</code></pre>
<table>
<caption>(#tab:skim_movies)Data summary</caption>
<tbody>
<tr class="odd">
<td align="left">Name</td>
<td align="left">movies</td>
</tr>
<tr class="even">
<td align="left">Number of rows</td>
<td align="left">2961</td>
</tr>
<tr class="odd">
<td align="left">Number of columns</td>
<td align="left">11</td>
</tr>
<tr class="even">
<td align="left">_______________________</td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left">Column type frequency:</td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left">character</td>
<td align="left">3</td>
</tr>
<tr class="odd">
<td align="left">numeric</td>
<td align="left">8</td>
</tr>
<tr class="even">
<td align="left">________________________</td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left">Group variables</td>
<td align="left">None</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: character</strong></p>
<table>
<thead>
<tr class="header">
<th align="left">skim_variable</th>
<th align="right">n_missing</th>
<th align="right">complete_rate</th>
<th align="right">min</th>
<th align="right">max</th>
<th align="right">empty</th>
<th align="right">n_unique</th>
<th align="right">whitespace</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">title</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">83</td>
<td align="right">0</td>
<td align="right">2907</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">genre</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">5</td>
<td align="right">11</td>
<td align="right">0</td>
<td align="right">17</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">director</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">3</td>
<td align="right">32</td>
<td align="right">0</td>
<td align="right">1366</td>
<td align="right">0</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: numeric</strong></p>
<table>
<colgroup>
<col width="15%" />
<col width="7%" />
<col width="11%" />
<col width="9%" />
<col width="9%" />
<col width="5%" />
<col width="8%" />
<col width="8%" />
<col width="8%" />
<col width="9%" />
<col width="4%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">skim_variable</th>
<th align="right">n_missing</th>
<th align="right">complete_rate</th>
<th align="right">mean</th>
<th align="right">sd</th>
<th align="right">p0</th>
<th align="right">p25</th>
<th align="right">p50</th>
<th align="right">p75</th>
<th align="right">p100</th>
<th align="left">hist</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">year</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">2002.90</td>
<td align="right">9.95</td>
<td align="right">1920.0</td>
<td align="right">1999.0</td>
<td align="right">2004.0</td>
<td align="right">2010.0</td>
<td align="right">2016.0</td>
<td align="left">▁▁▁▂▇</td>
</tr>
<tr class="even">
<td align="left">duration</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">109.65</td>
<td align="right">22.17</td>
<td align="right">37.0</td>
<td align="right">95.0</td>
<td align="right">106.0</td>
<td align="right">119.0</td>
<td align="right">330.0</td>
<td align="left">▃▇▁▁▁</td>
</tr>
<tr class="odd">
<td align="left">gross</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">58090400.90</td>
<td align="right">72469621.94</td>
<td align="right">703.0</td>
<td align="right">12276810.0</td>
<td align="right">34703228.0</td>
<td align="right">75590286.0</td>
<td align="right">760505847.0</td>
<td align="left">▇▁▁▁▁</td>
</tr>
<tr class="even">
<td align="left">budget</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">40619384.06</td>
<td align="right">43682007.78</td>
<td align="right">218.0</td>
<td align="right">11000000.0</td>
<td align="right">26000000.0</td>
<td align="right">55000000.0</td>
<td align="right">300000000.0</td>
<td align="left">▇▂▁▁▁</td>
</tr>
<tr class="odd">
<td align="left">cast_facebook_likes</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">12393.76</td>
<td align="right">20530.11</td>
<td align="right">0.0</td>
<td align="right">2241.0</td>
<td align="right">4604.0</td>
<td align="right">16926.0</td>
<td align="right">656730.0</td>
<td align="left">▇▁▁▁▁</td>
</tr>
<tr class="even">
<td align="left">votes</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">109307.49</td>
<td align="right">158143.91</td>
<td align="right">5.0</td>
<td align="right">19918.0</td>
<td align="right">55749.0</td>
<td align="right">133348.0</td>
<td align="right">1689764.0</td>
<td align="left">▇▁▁▁▁</td>
</tr>
<tr class="odd">
<td align="left">reviews</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">503.31</td>
<td align="right">493.74</td>
<td align="right">2.0</td>
<td align="right">199.0</td>
<td align="right">364.0</td>
<td align="right">631.0</td>
<td align="right">5312.0</td>
<td align="left">▇▁▁▁▁</td>
</tr>
<tr class="even">
<td align="left">rating</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">6.39</td>
<td align="right">1.05</td>
<td align="right">1.6</td>
<td align="right">5.8</td>
<td align="right">6.5</td>
<td align="right">7.1</td>
<td align="right">9.3</td>
<td align="left">▁▁▆▇▁</td>
</tr>
</tbody>
</table>
</div>
<div id="use-ggplot-to-answer-the-following" class="section level2">
<h2>Use <code>ggplot</code> to answer the following</h2>
<ul>
<li>Examine the relationship between <code>gross</code> and <code>cast_facebook_likes</code>. Produce a scatterplot and write one sentence discussing whether the number of facebook likes that the cast has received is likely to be a good predictor of how much money a movie will make at the box office. What variable are you going to map to the Y- and X- axes?</li>
</ul>
<pre class="r"><code>gross_on_fblikes &lt;- ggplot(movies, aes(x = cast_facebook_likes, y = gross)) + #chose likes on the x-axis, because hypothetically likes influence gross sales and not the other way around
  geom_point(alpha = 0.2) + 
  scale_x_log10() + #applied log scale on both axis to get a better view of the data in the plot
  scale_y_log10() + 
  geom_smooth(method = lm) + # applied geom smooth to get a trend line
  labs(
    title = &quot;Relationship between Facebook likes and gross earnings&quot;,
    x = &quot;Facebook likes&quot;,
    y = &quot;Gross earning&quot;
  ) +
  theme_minimal() + 
  NULL

gross_on_fblikes</code></pre>
<p><img src="/blogs/imdb_files/figure-html/gross_on_fblikes-1.png" width="648" style="display: block; margin: auto;" />
&gt;Answer</p>
<ul>
<li><p>We use “cast_facebook_likes” to map the the X-axes and “gross” to map the Y-axes.</p></li>
<li><p>The number of facebook likes that the cast has received can predicts the gross box office. The more facebook likes the movie’s cast receives, the more money it will make. However, the positive correlation is not very strong, since given the same “cast_facebook_likes”, the deviation of “gross” is quite large, which makes the fitted correlation contain large errors.</p></li>
<li><p>Examine the relationship between <code>gross</code> and <code>budget</code>. Produce a scatterplot and write one sentence discussing whether budget is likely to be a good predictor of how much money a movie will make at the box office.</p></li>
</ul>
<pre class="r"><code>gross_on_budget &lt;- ggplot(movies, aes(
  x = budget, 
  y = gross
  )) + 
  geom_point(alpha = 0.2) + 
  scale_x_log10() + 
  scale_y_log10() + 
  geom_smooth(method = lm) + 
  labs(
    title = &quot;Relationship between gross earnings and budget&quot;,
    x = &quot;Budget&quot;,
    y = &quot;Gross earnings&quot;
  ) +
  theme_minimal() +
  NULL

gross_on_budget</code></pre>
<p><img src="/blogs/imdb_files/figure-html/gross_on_budget-1.png" width="648" style="display: block; margin: auto;" />
&gt;Answer</p>
<p>Budget is likely to be a good predictor, since most of the data points are distributed closely near to the fitted line, especially in the upper right corner of the plot.</p>
<ul>
<li>Examine the relationship between <code>gross</code> and <code>rating</code>. Produce a scatterplot, faceted by <code>genre</code> and discuss whether IMDB ratings are likely to be a good predictor of how much money a movie will make at the box office. Is there anything strange in this dataset?</li>
</ul>
<pre class="r"><code>gross_on_rating_plot &lt;-ggplot(movies %&gt;% 
  distinct(), #Used distinct function to remove duplicate rows                               
       aes(
       x = rating, 
       y = gross
       )) + 
  geom_point(alpha = 0.2) + 
  scale_x_log10() + 
  scale_y_log10() + 
  facet_wrap(~genre) + #faceted the graphs per genre
  geom_smooth(method = lm) + 
  labs(
    title = &quot;Relationship between rating and gross earnings&quot;,
    x = &quot;Rating&quot;,
    y = &quot;Gross earnings&quot;
  ) +
  theme_minimal() +
  NULL

gross_on_rating_plot</code></pre>
<p><img src="/blogs/imdb_files/figure-html/gross_on_rating-1.png" width="648" style="display: block; margin: auto;" />
&gt;Answer</p>
<ul>
<li>For action, adventure, animation, biography, fantasy, and horror movies, IMDB ratings are good predictors, since the distance between data points and the fitted line are rather short, which means the fitted line contains less errors. While for comedy, crime, drama and Sci-Fi movies, the correlation between two variables are rather weak. For some genres, the data are not abundant enough to prove correlations (i.e. family, musical, romance, thriller and western).</li>
<li>There is something strange in this dataset. Some entries are almost the same to each other(titles, directors, year, etc. are all the same) except for votes.</li>
</ul>
</div>

                        </div>
                    </section>
            <!-- Disqus Inject -->
                
            </div>
            
        <!-- Footer -->
            
                <!-- Footer -->
    <footer id="footer">
        <div class="inner">
            <ul class="icons">
                
                    <li><a href="https://twitter.com/pxu335" class="icon alt fa-twitter" target="_blank"><span class="label">Twitter</span></a></li>
                
                    <li><a href="https://www.facebook.com/peijun.xu.129/" class="icon alt fa-facebook" target="_blank"><span class="label">Facebook</span></a></li>
                
                    <li><a href="https://www.instagram.com/pxu335/" class="icon alt fa-instagram" target="_blank"><span class="label">Instagram</span></a></li>
                
                    <li><a href="https://github.com/peijun-xu" class="icon alt fa-github" target="_blank"><span class="label">GitHub</span></a></li>
                
                    <li><a href="https://www.linkedin.com/in/peijun-xu-84a500154/" class="icon alt fa-linkedin" target="_blank"><span class="label">LinkedIn</span></a></li>
                
            </ul>
            <ul class="copyright">
                <li>&copy; Peijun Xu</li>
                
                <li>Design:  <a href="https://www.html5up.net">HTML5 UP</a></li>
                
            </ul>
        </div>
    </footer>

            
        </div>

    <!-- Scripts -->
        <!-- Scripts -->
    <!-- jQuery -->
    <script src="/js/jquery.min.js"></script>
    <script src="/js/jquery.scrolly.min.js"></script>
    <script src="/js/jquery.scrollex.min.js"></script>
    <script src="/js/skel.min.js"></script>
    <script src="/js/util.js"></script>

    

    <!-- Main JS -->
    <script src="/js/main.js"></script>

    

    

    </body>
</html>
